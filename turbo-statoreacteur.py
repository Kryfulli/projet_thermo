import numpy as np
import matplotlib.pyplot as plt
import csv
import random

#variables
#Tt4=1600

gamma=1.4
#cp=1004 #cp massique
#PCI=42.8*(10**6)
Patm=1.0
g=9.81
r=287.0
R=8.314
Tb=2000.0
T_H2=20.0


#Valeurs numériques
M_H2=2*0.001
M_O2=32*0.001
M_N2=28.0*0.001

#flux echangeur de chaleur
flux_1_5=50000.0 #J


#conditions nominales
Dn=180.0
Tn=288.0
Pn=1.0
PIn=6.67

#definition des listes
P=[]
T=[]
Pt=[]
Tt=[]

#CRS-CFR
cr = csv.reader(open("CRS-CFR.csv","rb"))
CFR1=[]
CRS=[]
for row in cr:
    CFR1.append(float(row[0][0:15]))
    CRS.append(float(row[0][18:32]))


#RPR-CFR tous les valeurs qui sont des pourcentages sont multiplies par 100
cr = csv.reader(open("RPR-CFR.csv","rb"))
RPR=[]
CFR2=[]
for row in cr:
    CFR2.append(float(row[0][0:15]))
    RPR.append(float(row[0][18:32]))


def cp_air(T) :
    if T<1000.0 :
        a_N2=[0.02926640E+02,0.14879768E-02,-0.05684760E-05,0.10097038E-09,-0.06753351E-13,-0.09227977E+04,0.05980528E+02]
        a_O2=[3.28253784E+00,1.48308754E-03,-7.57966669E-07,2.09470555E-10,-2.16717794E-14,-1.08845772E+03,5.45323129E+00]
        Cp_N2 = R*(a_N2[0] + a_N2[1]*T + a_N2[2]*(T**2.0) + a_N2[3]*(T**3.0) + a_N2[4]*(T**4.0))
        Cp_O2 = R*(a_O2[0] + a_O2[1]*T + a_O2[2]*(T**2.0) + a_O2[3]*(T**3.0) + a_O2[4]*(T**4.0))
        Cp_air=0.78*Cp_N2/M_N2+0.21*Cp_O2/M_O2
    else :
##        a_N2=[0.03298677E+02,0.14082404E-02,-0.03963222E-04,0.05641515E-07,-0.02444854E-10,-0.10208999E+04,0.03950372E+02]
##        a_O2=[3.78245636E+00,-2.99673416E-03,9.84730201E-06,-9.68129509E-09,3.24372837E-12,-1.06394356E+03,3.65767573E+00]
##        Cp_N2 = R*(a_N2[0] + a_N2[1]*T + a_N2[2]*(T**2.0) + a_N2[3]*(T**3.0) + a_N2[4]*(T**4.0))
##        Cp_O2 = R*(a_O2[0] + a_O2[1]*T + a_O2[2]*(T**2.0) + a_O2[3]*(T**3.0) + a_O2[4]*(T**4.0))
##        Cp_air=0.78*Cp_N2/M_N2+0.21*Cp_O2/M_O2
        return(cp_air(999))
    return(Cp_air)

def cp_H2(T) :
    if T<1000.0 :
        a_H2=[3.33727920E+00,-4.94024731E-05,4.99456778E-07,-1.79566394E-10,2.00255376E-14,-9.50158922E+02,-3.20502331E+00]
        Cp_H2 = R*(a_H2[0] + a_H2[1]*T + a_H2[2]*(T**2.0) + a_H2[3]*(T**3.0) + a_H2[4]*(T**4.0))
    else :
##      a_H2=[2.34433112E+00,7.98052075E-03,-1.94781510E-05,2.01572094E-08,-7.37611761E-12,-9.17935173E+02,6.83010238E-01]
##      Cp_H2 = R*(a_H2[0] + a_H2[1]*T + a_H2[2]*(T**2.0) + a_H2[3]*(T**3.0) + a_H2[4]*(T**4.0))
        return(cp_H2(999))
    return(Cp_H2/M_H2)

def T0(z):
    a=0.0065
    Ti=20.0
    res=Ti-(a*float(z))
    res=273.15+res
    if (res<3.0) :
        res=3.0
    
    return(res)
    


def Tt0 (M0,z) : 
    return(T0(z)*(1.0+(gamma-1.0)/2.0*M0*M0))

def P0 (z) :
    return(Patm*np.exp(-7.0*g*z/(2.0*cp_air(T0(z))*T0(z))))

def Pt0 (M0,z) :
    return(P0(z)*((1.0+(gamma-1.0)/2.0*M0*M0)**(gamma/(gamma-1.0))))

def Pt1 (M0,z) :
    if M0<1.0 :
        Pt1=Pt0(M0,z)*0.95
    else :
        Pt1=Pt0(M0,z)*(0.95-0.075*((M0-1)**1.35))
    return (Pt1)

def Tt1 (M0,z) :
    
    return (Tt0(M0,z)*((Pt1(M0,z)/Pt0(M0,z))**((gamma-1.0)/gamma)))

def T1(M0,z):
    return (Tt1(M0,z)/(1.0+(gamma-1.0)/2.0*(M0**2.0)))

def T2 (M0,z) :
    flux_sortie=cp_air(T1(M0,z))*float(T1(M0,z))+float(flux_1_5)
    
    a=200.0
    b=3500.0
    while abs(b-a)>0.01 :
        m=(a+b)/2.0
        
        if (cp_air(m)*m)>flux_sortie :
            b=m
        else :
            a=m
    return((a+b)/2.0)

def Tt2(M0,z) :
    return (T2(M0,z)*(1.0+(gamma-1.0)/2.0*(M0**2.0)))


def Pt2 (M0,z) :
    return (Pt1(M0,z)*((Tt2(M0,z)/Tt1(M0,z))**(gamma/(gamma-1.0))))


def CRS_to_CFR (CRS_0) :
    k=0
    while (k<len(CRS)-1) and (CRS[k]<CRS_0) :
            k+=1
    if k>=len(CRS)-1 :
        return (CFR1[len(CRS)-1])
    else :
        t=(CRS_0-CRS[k-1])/(CRS[k]-CRS[k-1])
        CFR_0=CFR1[k]*t+CFR1[k-1]*(1-t)
    return (CFR_0)
    
def CFR_to_RPR (CFR_0) :
    k=0
    while (k<len(RPR)-1) and (CFR2[k]<CFR_0)  :
        k+=1
    if k>=len(RPR)-1 :
        return (RPR[len(RPR)-1])
    else :
        t=(CFR_0-CFR2[k-1])/(CFR2[k]-CFR2[k-1])
        RPR_0=RPR[k]*t+RPR[k-1]*(1-t)
        return (RPR_0)

def theta2(M0,z):
    return(Tt2(M0,z)/Tn)

def delta2 (M0,z) :
    return (Pt2(M0,z)/Patm)

def CRS_0 (M0,z) :
    return(100.0/((theta2(M0,z))**0.5))

def RPR_0 (M0,z) :
    RPR_0=CFR_to_RPR(CRS_to_CFR(CRS_0(M0,z)))
    return(RPR_0)

def CFR_0(M0,z):
    CFR_0=CRS_to_CFR (CRS_0(M0,z))
    return (CFR_0)

def PI (M0,z) :
    return (PIn*RPR_0(M0,z))

def Pt3(M0,z) :
    return (Pt2(M0,z)*PI(M0,z))

def Tt3(M0,z) :
    return (Tt2(M0,z)*(PI(M0,z)**((gamma-1.0)/gamma)))

def T3(M0,z):
    return (Tt3(M0,z))

def D_air (M0,z) :
    return (Dn*CFR_0(M0,z)/100.0*delta2 (M0,z)/(theta2(M0,z)**(0.5)))

def flux_massique_3_4(M0,D_H2,z): 
    return ((((D_H2*cp_H2(Tb)+D_air(M0,z)*cp_air(Tb))*Tb)-(D_H2*cp_H2(T_H2)*T_H2)-(D_air(M0,z)*cp_air(T3(M0,z))*T3(M0,z)))/(D_H2+D_air(M0,z)))

def Pt4(M0,z) :
    return (Pt3(M0,z)*((Tb/T3(M0,z))**(gamma/(gamma-1.0))))

def Tt4(M0,z):
    return (Tt3(M0,z)*((Pt4(M0,z)/Pt3(M0,z))**((gamma-1.0)/gamma)))


def T5(M0,D_H2,z) :
    flux_sortie=((cp_air(Tb)*D_air(M0,z)+cp_H2(Tb)*D_H2)*Tb/(D_H2+D_air(M0,z)))+flux_1_5-(flux_massique_3_4(M0,D_H2,z))
    a=0.0
    b=3500.0
    while abs(b-a)>0.01 :
        
        m=(a+b)/2.0
        if cp_air(m)*m>flux_sortie :
            b=m
        else :
            a=m
    return((a+b)/2.0)

def Pt5(M0,D_H2,z) :    
    return (Pt4(M0,z)*((T5(M0,D_H2,z)/Tb)**(gamma/(gamma-1.0))))

def M9 (M0,D_H2,z) :
    
    res=Pt5(M0,D_H2,z)/P0(z)
    res=res**((gamma-1.0)/gamma)
    
    res=2.0*(res-1.0)/(gamma-1.0)
    if res<0 : 
        res=res**0.5
    return(res)



def a0(z) :
    
    return((gamma*r*T0(z))**0.5)

def Fsp (M0,D_H2,z) :
    res=M9(M0,D_H2,z)*(((Tt4(M0,z)/T0(z))/(Tt3(M0,z)/Tt2(M0,z))/(Tt0(M0,z)/T0(z)))**0.5)
    res=a0(z)*(res-M0)
    return(res)

def f_D(M0,D_H2,z) :
##    res=Tt4(M0,z)/T0(z)-Tt3(M0,z)/Tt2(M0,z)*Tt0(M0,z)/T0(z)
##    res=res*T0(z)
##    res=res*gamma*r/(gamma-1)
##    res=res/PCI
    res=D_H2/D_air(M0,z)
    return(res)
    
def v9 (M0,D_H2,z) :
    return((Fsp(M0,D_H2,z)/a0(z)+M0)*a0(z))

def rendement_p(M0,D_H2,z):
    return((2*M0)/(v9(M0,D_H2,z)/a0(z)+M0))

def rendement_th(M0,z) :
    return (1.0-(1.0/(Tt3(M0,z)/Tt2(M0,z)*Tt0(M0,z)/T0(z))))

def rendement_global(M0,D_H2,z) :
    return (rendement_p(M0,D_H2,z)*rendement_th(M0,z))



dt=1.0
T=600.0
angle_gamma=5.0/360.0*2.0*np.pi
angle_alpha=5.0/360.0*2.0*np.pi
f=10.0
Cz=2.0*np.pi*angle_alpha
Cx=Cz/f
Masse_mol=28.976E-03
Rmax=7000.0
m_engin=200*1000

def masse_vol(z) :
    return (P0(z)*100000.0*Masse_mol/(R*T0(z)))

def f_D_H2_liste() :
    res=[5.0,5.0]
    for i in range (int(T/dt)) :
        res.append(5.0)
    return (res)


def f_x_z_liste(D_H2_liste):
    x=[0.0,0.0]
    z=[0.0,0.0]
    M=[0.0,0.0]
    t=[0.0,0.0]
    D_H2=D_H2_liste
    
    for i in  range (int(T/dt)):
        t.append(float(i+1)*dt)
        V0=((((x[i+1]-x[i])/dt)**2.0)+(((z[i+1]-z[i])/dt)**2.0))**0.5
        M.append(V0/((gamma*R/Masse_mol*T0(z[i+1]))**0.5))
        x.append((dt**2.0)*(-1.0*g*np.sin(angle_alpha)-0.5*Cx*masse_vol(z[i+1])*g/Rmax*(V0**2)+Fsp(M[i+1],D_H2[i+1],z[i+1])*np.cos(angle_alpha)*(D_H2[i+1]+D_air(M[i+1],z[i+1]))/m_engin)-x[i]+2*x[i+1])
        z.append((dt**2.0)*(-1.0*g*np.cos(angle_alpha)+0.5*Cz*masse_vol(z[i+1])*g/Rmax*(V0**2)+Fsp(M[i+1],D_H2[i+1],z[i+1])*np.sin(angle_alpha)*(D_H2[i+1]+D_air(M[i+1],z[i+1]))/m_engin)-z[i]+2*z[i+1])  
        if M[i+2]>7.5 :
            M[i+2]=7.5
        if z[i+2]>40000.0 :
            z[i+2]=40000.0
        elif z[i+2]<0.0 :
            z[i+2]=0.0
    return(x,z,M,t)


delta_variation_D_H2=0.1

def variation_de_liste_D_H2(D_H2_liste,nombre_de_variations):
    res=[]
    for k in range (0,len(D_H2_liste)):
        res.append(D_H2_liste[k]+((random.random()-0.5)*2.0*delta_variation_D_H2*float(nombre_de_variations+1)))
        if res[k]<=0 :
           res[k]=0.01
    return(res)

nombre_de_variations_max=50
nombre_de_changements_de_liste_max=500


def optimization_D_H2_liste () :
    D_H2_liste1=f_D_H2_liste()
    res1=f_x_z_liste(D_H2_liste1)
    z_liste1=res1[1]
    M0_liste1=res1[2]
    z_f1=z_liste1[-1]
    M0_f1=M0_liste1[-1]
    nombre_de_variations=0
    nombre_de_changements_de_liste=0
    while (nombre_de_variations_max>nombre_de_variations) and (nombre_de_changements_de_liste_max>nombre_de_changements_de_liste) :
        D_H2_liste2=D_H2_liste1
        D_H2_liste2=variation_de_liste_D_H2(D_H2_liste2,nombre_de_variations)
        res2=f_x_z_liste(D_H2_liste2)
        z_liste2=res2[1]
        M0_liste2=res2[2]
        z_f2=z_liste2[-1]
        M0_f2=M0_liste2[-1]
        if (abs(z_f1-27000.0)>abs(z_f2-27000.0)) and (abs(z_f1-27000.0)<=100.0) :
            if (abs(M0_f1-6.0)>abs(M0_f2-6.0)) and (abs(M0_f1-6.0)<=0.1) :
                if (sum(D_H2_liste1)<sum(D_H2_liste2)) :
                    D_H2_liste1=D_H2_liste2
                    z_f1=z_f2
                    M0_f1=M0_f2
                    nombre_de_changements_de_liste+=1
                    nombre_de_variations=0
                else :
                    nombre_de_variations+=1
            elif (abs(M0_f1-6.0)>abs(M0_f2-6.0)) and (abs(M0_f1-6.0)>0.1) :
                D_H2_liste1=D_H2_liste2
                z_f1=z_f2
                M0_f1=M0_f2
                nombre_de_changements_de_liste+=1
                nombre_de_variations=0
            else :
                nombre_de_variations+=1
        elif (abs(z_f1-27000.0)>abs(z_f2-27000.0)) and (abs(z_f1-27000.0)>100.0) :
            D_H2_liste1=D_H2_liste2
            z_f1=z_f2
            M0_f1=M0_f2
            nombre_de_changements_de_liste+=1
            nombre_de_variations=0
        else :
            nombre_de_variations+=1
        print("nombre_de_variations :",nombre_de_variations)
        print("nombre_de_changements_de_liste :",nombre_de_changements_de_liste)
    return(D_H2_liste1)
        


    

#D_H2_liste=optimization_D_H2_liste ()
D_H2_liste=[14.451506869604168, 12.384761036727047, 10.806646217181306, 10.999697276167515, 0.3203676646157651, 6.804614456548706, 1.9789662277231999, 7.605986409881035, 0.6719503611501049, 0.9693854240597102, 0.7200459204744998, 0.7557298111072046, 15.14552144191971, 15.948578114938945, 4.347527704960685, 1.9856252209886285, 7.465171376857942, 11.690023520458766, 9.896838646797129, 14.060966252266015, 8.914689382078455, 10.87568015614443, 8.987902987876781, 2.3166016191561707, 8.307329558185426, 5.930950182532924, 6.832491487369014, 2.384807683419126, 7.924416315878292, 4.743593706893375, 10.26538661904696, 15.649824021383692, 1.9552756838726681, 8.721382416394746, 2.807151867165739, 9.544900539926031, 3.5616466187717934, 3.0720109694429327, 13.434432959892181, 7.609534875963314, 4.387942958070276, 10.288439240444676, 5.900282491929617, 3.55508207796261, 5.322669987324843, 8.204363108838168, 13.20304802423987, 4.287782026213476, 2.0715495915261743, 6.78693482734789, 1.3490738295277784, 6.3675499623014025, 0.12635278237248398, 7.067063028197867, 0.4571579898528255, 0.632555177167544, 3.2926870676847906, 0.055191177946255277, 15.991165898878938, 9.359771696087842, 3.7428521462235165, 13.604713979422545, 5.524484315154976, 12.615132258585763, 12.111908762290781, 2.723015823269971, 3.3523382671819957, 12.135814025199892, 9.79495290307455, 6.598017397753685, 6.21973950109057, 16.855178668774432, 11.811757648083454, 1.652327694217124, 4.652387900641301, 7.291360773151748, 17.516245593048936, 15.493564203454575, 9.982608130300182, 5.241402129564124, 1.3512974130693296, 8.393415711349162, 10.007429127572243, 0.896074965978352, 8.655671539147876, 4.516735279153083, 9.07729527912237, 8.743076939474522, 10.522966075826547, 13.337515405270464, 12.441242342055629, 1.5085321960075495, 15.814570028751328, 12.474131506011014, 1.9504829525546743, 11.485869070268286, 6.469764872085346, 12.235229116202712, 10.99584682255255, 0.15274430341802808, 11.16419914053602, 10.55925658519429, 8.415590721692963, 2.6935974411333516, 2.296941717278867, 0.9757914817899672, 11.25608418256209, 19.940002450246666, 4.563679774358924, 7.041900174984792, 10.033745191210647, 2.7767684040866594, 8.406183586564202, 18.9134314309708, 5.829297776412505, 17.061731868033025, 5.101347407607852, 9.480840078110864, 7.294729044346578, 15.801800920319115, 0.7770566250203338, 12.813557066924734, 3.3551251409377496, 6.94012251235771, 2.3567898596676953, 7.711653807463666, 10.192930039885171, 18.235314800837813, 3.457381683043416, 1.133277736655399, 9.738402209332524, 16.66717813312632, 3.3711930089624005, 14.566390619970564, 2.4244642321786585, 15.133392957163641, 11.42832455395972, 14.201649440092607, 7.730794454206502, 10.61699187663387, 4.21334626840792, 4.311595733719821, 8.46569886842627, 12.4294615317442, 2.2952176752825064, 3.1797124354576702, 2.569670536664349, 10.284927047316124, 18.648313102811816, 18.66195356583872, 15.70114225070128, 11.289699937944091, 12.097068951866886, 8.874714622296336, 20.15593751315064, 0.9706354135817318, 0.38634854899945986, 7.726838510065934, 12.862845117812407, 6.474682344981944, 0.4825309400412342, 23.433820370263813, 7.277331613449284, 5.135887239585809, 4.857808583160464, 11.315653502647363, 14.208607824234424, 12.056476148104514, 2.4289618048455264, 12.801101716181268, 12.195888087585706, 3.213698587536311, 4.783485614029339, 9.278878211640585, 6.103930767405922, 9.593565746177916, 4.6076422060675775, 11.587126249490494, 7.1256682672475256, 8.609719424094457, 6.759715623406793, 1.4235232023396822, 0.2457757634753843, 13.58200034603913, 3.04733540341866, 3.77712634874012, 4.130815873715202, 9.550430412340617, 11.864664142467934, 9.939172140309612, 15.12863416069881, 0.2346532149049334, 0.2974549663692117, 3.2207354615404444, 9.851990040345894, 1.9046099413891289, 1.7090065220892174, 2.817626338298499, 16.6259845126622, 3.0454038730412005, 4.714215286265142, 4.166037892110998, 2.096598419319028, 13.12404065737467, 2.3718585061759048, 7.742963245592187, 11.37186642519547, 17.362365487930184, 0.44235452218189947, 4.176349367648479, 2.3853833432380576, 3.1311490676706235, 2.6726877333963603, 0.850457341538554, 12.323961449623011, 2.68863793044982, 10.746309428403464, 0.0024984883274171005, 3.533194723555946, 4.4455072169819445, 11.171765074069205, 6.716260167433388, 19.246759023204717, 6.711085429764044, 15.899007971880398, 2.810884757679723, 10.305687392192125, 7.496944044997429, 0.15433919810370123, 7.709095670379114, 2.0419014606525896, 1.7155170059174223, 5.0296944371108285, 1.8578372078262546, 13.870630423725387, 5.781810687808977, 19.273979837104218, 1.3079923033819902, 9.792457890464936, 4.567598473132714, 8.945414740511694, 15.076419542076238, 10.102226774305539, 4.538944814243611, 6.602908421141508, 7.707765715008522, 9.627432430063312, 2.8345726124876065, 7.094862722283505, 6.615864465212507, 0.9461782046867225, 1.0848734327853173, 5.603983700351362, 10.65189543722385, 10.3551407597368, 0.3081743282553946, 10.469667179577161, 1.392789825553193, 21.49463564393974, 10.597961109935994, 3.5787608191166806, 5.624511614350214, 10.31564626123066, 1.8509569447201295, 1.2904428375332582, 19.344324579645015, 6.841006009149779, 4.296495104669277, 0.01, 1.7498368547241494, 7.513773045763902, 10.930929764743444, 0.869309303640459, 10.552479704582181, 11.704915674689804, 8.944192978282631, 18.068296182309695, 4.48647771012105, 10.081026686808785, 10.238137703524245, 7.48337398554227, 7.31764782158165, 1.9244652928285326, 6.828227299953054, 2.125517080674105, 9.201004670382774, 0.4154650331579629, 15.961579500989554, 5.029348587743221, 14.807021055727745, 5.724059761448598, 10.719429016910043, 22.148753761446454, 3.033007423274907, 16.457819313506313, 6.275469152182615, 3.429840959214867, 17.9468828448251, 10.169367621440514, 3.324034346918765, 18.558989370290565, 8.93754291856111, 13.14182523356743, 0.7306465194852785, 0.3671437210295495, 23.10139226070372, 10.939661893923969, 10.10886693779559, 6.645519550266771, 16.166015098083225, 9.505058323779048, 10.68307695402443, 15.6960059910006, 17.865096647848972, 2.082957588036596, 2.7334403082880616, 10.583796656186815, 14.461727120688153, 12.456111186989734, 11.196722731678276, 2.7213587232453063, 7.1060357508353205, 6.738642197520844, 3.2567561572388044, 5.848833690815737, 7.576856910713719, 4.682801032596822, 2.4167061681644744, 6.587958488174284, 10.515458503260101, 4.509801923950737, 6.05031667424399, 9.763033678162614, 6.482624450266392, 7.215741989624522, 6.781013973653491, 2.51520225748362, 2.9414343977019946, 14.12933950828563, 0.928339333523976, 19.993574401061792, 12.943736548352572, 16.372277919604954, 5.5877061734820135, 14.79014063715377, 7.647036381998623, 8.993001948341911, 2.0178799862929218, 3.255570577770901, 5.324688620756729, 12.723260301583608, 7.844411471205861, 9.569184704023847, 0.9942605601890541, 2.9976006603683345, 7.670338923990817, 6.149071476981019, 11.139384990842194, 5.008767243333088, 6.2155637786213065, 8.769096057020327, 7.572432691235928, 7.064662774826963, 5.88427519711191, 9.815760639832552, 4.288993019181014, 13.604716967305377, 1.4101384271257378, 18.633788001503067, 7.109074768147034, 1.5634877887036174, 4.193016079814889, 6.9051424422722825, 4.676066645152941, 1.5256413048681674, 0.6913731605482628, 9.14652059411399, 7.3641281847570355, 9.77094533298879, 2.3024580729763215, 11.455584001379766, 2.731656829375544, 5.4615938948711955, 1.3523957612344968, 2.0846163564654177, 8.062168179268882, 5.296452166840189, 5.620995527187237, 5.894217358123219, 2.0234246183001448, 8.669409850917067, 1.3326590622970562, 0.8558264808792098, 1.9433026351530682, 10.496358256268886, 12.433502134155132, 0.7860234970184525, 1.7325961103221672, 17.423523057099185, 0.6460272597811703, 3.36708407519432, 14.287885871596737, 8.603921754340961, 12.35091684625258, 1.481270025496958, 1.350512801703481, 11.524458562941936, 3.2819310960088988, 11.149633252368126, 8.335559527194564, 10.766461413199373, 15.272116370156189, 4.538148249219482, 1.310235770592746, 16.826840862784387, 3.508420112409013, 8.98260026639909, 1.8494733379175112, 2.2338322903098424, 1.3377802388915592, 19.38920326747525, 1.5421330862698468, 3.7008369172763467, 1.002124870486834, 2.889814725997646, 12.777626844401853, 1.2512522511685567, 20.157842298514822, 10.833283078315416, 16.903817238520315, 2.221463113452332, 5.099223715993159, 10.452888166377578, 9.294708622818973, 16.71873013135157, 13.660608820570582, 1.0260054563892562, 9.593391983158591, 3.6400476921846514, 11.778370950232857, 9.164063508334895, 5.8345880004302755, 7.731656858193806, 8.54045277332915, 9.702889722236767, 10.066726576610622, 2.6128361661933748, 6.572043967523032, 6.20209234885575, 11.767978789492641, 0.35143373950788515, 7.421708228179821, 3.664919098329217, 6.680464301218397, 8.043697118893677, 7.445334316442403, 9.928952471761749, 7.685051431289857, 8.726149728629563, 14.526702177379391, 4.970349075955009, 1.447946183909786, 3.9690845526782637, 12.255562138538656, 2.2434146482950847, 0.5673447055162366, 14.96365285001999, 4.672274476770464, 1.423942279272018, 11.591372196769603, 7.531229282460838, 2.260564150154404, 0.5773672159310246, 2.31659435572485, 0.01, 0.7743880840173941, 6.519367061748862, 9.150578624429246, 2.3394544342723536, 0.8423971294924399, 6.3749594300478805, 14.578321479014457, 8.710464975682353, 15.708623475712027, 16.718622554539433, 22.426710839659428, 4.794869954822121, 14.135820446635607, 7.2496360122765156, 9.805825862701761, 8.906016696522276, 16.22651738557733, 4.290848724526607, 14.715777780298545, 1.8089283869460733, 15.907414123806149, 2.7191852469873186, 22.12077148592117, 3.330886648624598, 6.623631095768437, 2.9113177954257514, 0.9310626951050331, 9.209521322251497, 17.45176955002856, 8.272117003834358, 1.1691231545222855, 7.621450829867806, 0.010675051681492576, 0.6962256886579143, 12.575378019331868, 6.678262506539094, 2.638200759686937, 12.48791308129144, 6.9542621660079975, 9.507437030436726, 1.2898278018253588, 5.415901826145769, 3.8470286317288167, 13.195685027763005, 5.883951402928848, 8.243364670510719, 6.920378877344013, 4.586093998698999, 3.6323810661684184, 5.634340882098519, 9.093712344388681, 10.425768593061257, 13.218929234678082, 18.163898137319865, 4.118794003949959, 4.11008122938986, 23.851058949102473, 2.4035163285443746, 1.4563931240713122, 4.296590722341911, 16.056444135199047, 17.17623762541097, 2.887689038306585, 1.7722034783613263, 2.2255909743281403, 11.762229552211696, 0.6251973960933773, 6.789153890475147, 6.197382439333215, 1.1309290156300067, 8.542313538468118, 15.425602618551837, 6.94571775453202, 9.162255133958993, 8.147226949396378, 7.66613750505275, 14.319568278289958, 2.6946328086375617, 8.898602631146211, 3.9005455446518638, 12.110774399247362, 14.041908974769644, 6.88916639394904, 5.055873690922563, 1.7059968112603918, 7.9004539152454205, 8.476081679934659, 6.039003683577181, 10.05577214338271, 3.3840144275758415, 3.52603696309145, 4.425655609496031, 15.795952664007952, 10.12291448697982, 0.01, 4.28139447573941, 0.06839760945605187, 7.833891869170364, 1.1875152273845082, 0.6577677431209004, 0.01, 1.6911747342586865, 0.01, 0.43786686977858247, 0.9574501968443475, 0.3457118196658606, 0.29164961259702826, 1.213924395245976, 0.8269194868906116, 1.2328693778733832, 2.4283941989796474, 1.16803845802664, 1.189383434534792, 1.1024159206053177, 0.01, 0.40411491846972336, 2.7887345865527693, 1.2228959587411303, 1.2030055059666058, 2.2585621551811577, 4.868863284581478, 6.970145667087679, 0.05556928637969606, 2.7026048598930834, 1.136113185373082, 3.935785786210024, 1.940316516469962]
x_liste=f_x_z_liste(D_H2_liste)[0]
z_liste=f_x_z_liste(D_H2_liste)[1]
M0_liste=f_x_z_liste(D_H2_liste)[2]
t_liste=f_x_z_liste(D_H2_liste)[3]
print(D_H2_liste)
plt.plot(t_liste,z_liste)
plt.show()
